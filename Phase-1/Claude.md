# âš ï¸ IMPORTANT: UPDATE THIS DOCUMENT WHEN CHANGES OCCUR
**ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ í˜„ì¬ ìƒí™©ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì½”ë“œ ìˆ˜ì •, íŒŒì¼ ì¶”ê°€/ì‚­ì œ, ì „ëµ ë³€ê²½ ë“±ì´ ë°œìƒí•˜ë©´ ë°˜ë“œì‹œ ì´ ë¬¸ì„œë¥¼ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.**

---

# Phase-1 Project Status - Current Situation

**Last Updated**: February 10, 2026 (Updated: Khan data blocker resolved)
**Research Goal**: Dataset characterization for Small Language Model (SLM) pretraining
**Location**: UNLV Lab Research (Week 4/16)
**Researcher**: KeonSoo (bubbleguy10@gmail.com)

---

## ğŸ“Œ Current Blockers

### âœ… RESOLVED: Khan Academy Data Source

**Solution**: Using `HuggingFaceTB/cosmopedia` khanacademy subset

**Previously Tried (Failed)**:

1. âŒ Khan Academy API - `410 Gone` (deprecated as of ~2023)
2. âŒ HuggingFace `datasets` library in remote env - `403 Forbidden` (proxy)
3. âŒ Direct web scraping - React SPA, blocked in remote env

**Current Solution (âœ… Working)**:

- Source: `HuggingFaceTB/cosmopedia` khanacademy config (24,123 entries)
- Dual download strategy: `datasets` library â†’ direct parquet API fallback
- **18,764 entries saved** to `khan_k12_concepts/all_k12_concepts.json`
- Grades 3-12, all core subjects

| Subject          | Count  |
| ---------------- | ------ |
| Math             | 15,393 |
| Science          | 1,664  |
| Social Studies   | 1,394  |
| Language Arts    | 225    |
| Computer Science | 88     |

**Note**: Content is synthetically generated by Mixtral-8x7B using KA topics as seeds.
Suitable for taxonomy/classification purposes.

### ğŸŸ¡ REMAINING: Run Pipeline (Step 1 â†’ 2 â†’ 3)

- [ ] `python 1_extract_khan_taxonomy.py`
- [ ] `python 2_compute_metrics.py`
- [ ] `python 3_build_dashboard.py`

---

## ğŸ¯ Project Overview

### Research Question
**"How can we characterize pretraining datasets to optimize Small Language Model development?"**

### Methodology
Analyze educational datasets through 4 dimensions:
1. **Domain Coverage** (í˜„ì¬ êµ¬í˜„ë¨) - Multi-label classification using concept prototypes
2. **Quality** (í˜„ì¬ êµ¬í˜„ë¨) - Educational markers detection
3. **Difficulty** (ë³´ë¥˜) - Reading level analysis
4. **Redundancy** (ë³´ë¥˜) - Content deduplication metrics

### Key Technical Decision
**Vector-based multi-label soft assignment** (inspired by multi-head attention) instead of graph-based classification
- Allows cross-cutting concepts (documents spanning multiple domains)
- Provides probabilistic domain membership scores
- Computationally efficient for large datasets

---

## ğŸ“‚ Current File Structure

### Active Files (Production)
```
Phase-1/
â”œâ”€â”€ collect_khan_academy.py          # Step 0: Data collection (BLOCKED)
â”œâ”€â”€ collect_tinytextbooks.py         # Step 0: Tiny-Textbooks collection (WORKS)
â”œâ”€â”€ 1_extract_khan_taxonomy.py       # Step 1: Build concept prototypes (TF-IDF)
â”œâ”€â”€ 2_compute_metrics.py             # Step 2: Domain + Quality analysis
â”œâ”€â”€ 3_build_dashboard.py             # Step 3: Interactive HTML visualization
â”œâ”€â”€ config.py                        # Configuration constants
â”œâ”€â”€ utils.py                         # Shared utility functions
â”œâ”€â”€ README.md                        # Full pipeline documentation
â”œâ”€â”€ notion_research_log.md           # Research journal (Feb 10, 2026)
â””â”€â”€ Claude.md                        # THIS FILE - Current status
```

### Legacy Files (Archived)
```
legacy/
â”œâ”€â”€ 1_extract_khan_taxonomy_sbert.py   # SentenceTransformer version (requires network)
â”œâ”€â”€ 2_compute_metrics_sbert.py         # Full version with GPT-2 perplexity
â”œâ”€â”€ SETUP.md                           # Remote execution troubleshooting guide
â”œâ”€â”€ download_khan_data.py              # Failed HuggingFace download attempt
â””â”€â”€ [previous analysis files]          # Old graph-based experiments
```

---

## ğŸ”„ Pipeline Architecture

### Design Principles
1. **Remote-First**: Must work in fresh environment without local dependencies
2. **Offline-Compatible**: Use TF-IDF instead of HuggingFace models
3. **Incremental**: Each step produces reusable artifacts
4. **Transparent**: Interactive dashboard for visual exploration

### Current Pipeline Status

#### Step 0: Data Collection
**Status**: ğŸ”´ **BLOCKED** (Khan Academy download fails)

**Files**:
- `collect_khan_academy.py` - âŒ Cannot download
- `collect_tinytextbooks.py` - âœ… Works (requires HuggingFace datasets library)

**Expected Output**:
- `khan_k12_concepts/all_k12_concepts.json` - Educational concept taxonomy
- `tiny_textbooks_raw/batch_*.json` - 42 batches of synthetic textbook data

**Blocker**: Khan Academy API deprecated, HuggingFace blocked by remote proxy

---

#### Step 1: Extract Khan Taxonomy
**Status**: ğŸŸ¡ **READY** (waiting for Khan data)

**File**: `1_extract_khan_taxonomy.py`

**What It Does**:
1. Loads Khan Academy K-12 concepts
2. Builds TF-IDF vectors (300-dimensional)
3. Creates concept prototypes for each domain
4. Saves vectorizer for later text classification

**Output**:
- `outputs/khan_taxonomy.json` - Hierarchical concept structure
- `outputs/concept_prototypes_tfidf.pkl` - Domain vectors + vectorizer
- `outputs/metadata.json` - Statistics and processing info

**Technical Approach**:
- Uses sklearn `TfidfVectorizer` (max 300 features)
- Offline-compatible (no external model downloads)
- Trade-off: Lower quality than SentenceTransformers, but works remotely

---

#### Step 2: Compute Metrics
**Status**: ğŸŸ¡ **READY** (waiting for Step 1 output)

**File**: `2_compute_metrics.py`

**What It Does**:
1. Loads concept prototypes from Step 1
2. Chunks documents into ~200-word paragraphs
3. Classifies each chunk into top-5 domains (cosine similarity)
4. Detects educational markers (examples, explanations, structure)
5. Saves per-paragraph analysis

**Output**:
- `outputs/khan_analysis.jsonl` - Khan Academy analysis results
- `outputs/tiny_textbooks_analysis.jsonl` - Tiny-Textbooks analysis results

**Performance**:
- Default: 5 batches (~10 minutes) for testing
- Full run: 42 batches (~2 hours) - set `max_batches=None`

**Metrics Computed**:
- **Domain Labels**: Top-5 concepts with normalized similarity scores
- **Educational Markers**:
  - `has_examples`: "for example", "such as", "consider", etc.
  - `has_explanation`: "because", "therefore", "this means", etc.
  - `has_structure`: "first", "second", "in summary", etc.

**Not Computed** (removed for simplicity):
- âŒ Perplexity (would require GPT-2 download)
- âŒ Reading difficulty (deferred to future work)

---

#### Step 3: Build Dashboard
**Status**: ğŸŸ¡ **READY** (waiting for Step 2 output)

**File**: `3_build_dashboard.py`

**What It Does**:
1. Loads analysis results from Step 2
2. Aggregates statistics across datasets
3. Generates self-contained interactive HTML with Chart.js
4. Creates visualizations for domain distribution and quality

**Output**:
- `outputs/dashboard.html` - Interactive web dashboard

**Visualizations**:
- Domain coverage distribution (bar chart)
- Educational markers frequency (stacked bar chart)
- Dataset comparison (Khan vs Tiny-Textbooks)
- Word count statistics

**Requirements**:
- Needs internet to load Chart.js library from CDN
- All data embedded in HTML (portable)

---

## ğŸ’¡ Technical Decisions Log

### Decision 1: Vector-Based Instead of Graph-Based
**Date**: February 10, 2026
**Rationale**: Multi-label soft assignment better captures cross-cutting concepts (e.g., "algebraic geometry" spans both domains)
**Trade-off**: Less interpretable than explicit graph structure, but more flexible

### Decision 2: TF-IDF Instead of SentenceTransformers
**Date**: February 10, 2026
**Rationale**: Remote environment blocks HuggingFace model downloads
**Trade-off**: Lower embedding quality (300-dim vs 384-dim), but works offline

### Decision 3: Remove Perplexity Metrics
**Date**: February 10, 2026
**Rationale**: GPT-2 download fails in remote environment, perplexity not critical for initial analysis
**Trade-off**: Cannot measure text "surprisal", but educational markers still capture quality

### Decision 4: Khan Academy as Taxonomy Source
**Date**: February 10, 2026
**Rationale**: K-12 curriculum provides well-structured domain hierarchy
**Current Status**: âŒ BLOCKED - Cannot download data

---

## ğŸš§ Known Issues

### 1. Khan Academy Data Unavailable
**Severity**: ğŸ”´ **CRITICAL**
**Description**: Cannot download Khan Academy K-12 concepts
**Impact**: Entire pipeline blocked
**Workaround**: None currently
**Next Steps**: Research alternative data sources

### 2. Remote Proxy Restrictions
**Severity**: ğŸŸ¡ **MODERATE**
**Description**: HuggingFace datasets return 403 Forbidden
**Impact**: Cannot use cloud-hosted datasets
**Workaround**: Use TF-IDF for embeddings
**Next Steps**: Check if VPN or proxy settings can be adjusted

### 3. Dashboard Requires Internet
**Severity**: ğŸŸ¢ **LOW**
**Description**: Chart.js loaded from CDN
**Impact**: Dashboard won't render offline
**Workaround**: Manually download Chart.js and embed in HTML
**Next Steps**: Create fully offline version if needed

---

## ğŸ“Š Expected Results (When Unblocked)

### Dataset Statistics
- **Khan Academy**: ~1,000-10,000 educational concepts
- **Tiny-Textbooks**: ~100,000 synthetic paragraphs
- **Processing Time**: ~2 hours for full analysis

### Metrics Output
Each paragraph will have:
```json
{
  "source": "khan_academy",
  "doc_id": "https://...",
  "chunk_id": 0,
  "text": "...",
  "word_count": 157,
  "domain_labels": {
    "algebra_basics": 0.45,
    "equation_solving": 0.32,
    "linear_functions": 0.23
  },
  "educational_markers": {
    "has_examples": true,
    "has_explanation": true,
    "has_structure": false
  }
}
```

### Dashboard Insights
- Which domains are over/under-represented?
- How does Tiny-Textbooks compare to Khan Academy in educational quality?
- What percentage of content has explanatory structure?

---

## ğŸ” Research Context

### Background
- **Week 4/16** of UNLV lab research
- Building datasets for Small Language Model pretraining
- Previous work: Collected Khan Academy data (now inaccessible)

### Hypothesis
High-quality pretraining data should:
1. **Cover diverse domains** (not just coding or medical text)
2. **Include educational structure** (examples, explanations, not just facts)
3. **Match target difficulty** (appropriate for model size)
4. **Minimize redundancy** (avoid repeating same content)

### Current Focus
**Domain Coverage + Quality** - Other dimensions deferred to future work

---

## ğŸ“ Next Actions (Priority Order)

### Immediate (Critical)
1. **Resolve Khan Academy data source** - Research alternative download methods
2. **Test with mock data** - Create small synthetic Khan taxonomy to validate pipeline
3. **Document assumptions** - What if Khan data remains unavailable?

### Short-Term (This Week)
4. **Run end-to-end test** - Validate pipeline with 5-batch subset
5. **Verify metrics accuracy** - Manual spot-checks of domain classifications
6. **Create example visualizations** - Screenshots for research log

### Long-Term (Future Work)
7. **Add difficulty metrics** - Reading level analysis
8. **Add redundancy detection** - MinHash LSH for near-duplicates
9. **Scale to full dataset** - Optimize for 1M+ paragraphs
10. **Compare with other datasets** - Wikipedia, C4, etc.

---

## ğŸ¤ Contact & Collaboration

**Researcher**: KeonSoo (bubbleguy10@gmail.com)
**Location**: UNLV Lab
**Research Timeline**: 16 weeks total (currently week 4)

**Collaboration Notes**:
- This work builds on previous Khan Academy data collection
- Remote execution environment has network restrictions
- Focus on practical SLM training applications

---

## ğŸ“š References

### Documentation Files
- `README.md` - Full pipeline documentation with examples
- `notion_research_log.md` - Research journal entry (Feb 10, 2026)
- `legacy/SETUP.md` - Troubleshooting guide for remote execution

### Key Code Sections
- `1_extract_khan_taxonomy.py:58-70` - TF-IDF vectorization logic
- `2_compute_metrics.py:77-116` - Domain classification algorithm
- `2_compute_metrics.py:123-144` - Educational markers detection
- `3_build_dashboard.py` - Full dashboard generation (21k+ lines)

### External Resources
- HuggingFace Cosmopedia Dataset: https://huggingface.co/datasets/HuggingFaceTB/cosmopedia/viewer/khanacademy
- Khan Academy Website: https://www.khanacademy.org
- Tiny-Textbooks Paper: [Research citation needed]

---

## ğŸ”„ Version History

| Date | Change | Author |
|------|--------|--------|
| 2026-02-10 | Initial Claude.md creation | Claude (Sonnet 4.5) |
| 2026-02-10 | Cleaned up duplicate files (moved _sbert versions to legacy) | Claude |
| 2026-02-10 | Documented Khan Academy download blocker | Claude |

---

**End of Current Status Document**

*Remember: Update this file whenever you make changes to the project structure, strategy, or implementation!*
